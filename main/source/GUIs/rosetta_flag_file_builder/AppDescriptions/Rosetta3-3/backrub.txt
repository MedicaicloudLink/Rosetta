AUTHOR==Colin A. Smith
METADATA==This document was last updated August 10, 2010, by Colin A. Smith. The corresponding principal investigator is Tanja Kortemme <kortemme@cgl.ucsf.edu>.
EXAMPLES==he code for the backrub application is in src/apps/public/backrub.cc. An integration test and demo is located in test/integration/tests/backrub. Backrub moves are made with the BackrubMover. Side chain moves are made with the SidechainMover. Backbone phi/psi moves are made with the SmallMover.
REFERENCES==Smith CA, Kortemme T. Structure-Based Prediction of the Peptide Sequence Space Recognized by Natural and Synthetic PDZ Domains. J Mol Biol. http://dx.doi.org/10.1016/j.jmb.2010.07.032\nSmith CA, Kortemme T. Backrub-like backbone simulation recapitulates natural protein conformational variability and improves mutant side-chain prediction. J Mol Biol. 2008 Jul 18;380(4):742-56. http://dx.doi.org/10.1016/j.jmb.2008.05.023\nFriedland GD, Linares AJ, Smith CA, Kortemme T. A simple model of backbone flexibility improves modeling of side-chain conformational variability. J Mol Biol. 2008 Jul 18;380(4):757-74. http://dx.doi.org/10.1016/j.jmb.2008.05.006\nFriedland GD, Lakomek NA, Griesinger C, Meiler J, Kortemme T. A correspondence between solution-state dynamics of an individual protein and the sequence and conformational diversity of its family. PLoS Comput Biol. 2009 May;5(5):e1000393. http://dx.doi.org/10.1371/journal.pcbi.1000393\nDavis IW, Arendall WB 3rd, Richardson DC, Richardson JS. The backrub motion: how protein backbone shrugs when a sidechain dances. Structure. 2006 Feb;14(2):265-74. http://dx.doi.org/10.1016/j.str.2005.10.007\nBetancourt MR. Efficient Monte Carlo trial moves for polypeptide simulations. J check_button_m Phys. 2005 Nov 1;123(17):174905. http://dx.doi.org/10.1063/1.2102896
DESCRIPTION==This application is useful for creating ensembles of protein backbones, modeling protein flexibility, modeling mutations, and detailed refinement of backbone/side chain conformations.
ALGORITHM==The backrub algorithm rotates local segments of the protein backbone as a rigid body about an axis defined by the starting and ending atoms of the segment. It was inspired by observations made by Davis et al (Structure 2006) of alternate side chain/backbone conformations in high resolution crystal structures. Atoms branching of the main chain at the pivot points (side chains, hydrogens, carbonyl oxygens), are updated to minimize the bond angle strain incurred. These moves are accepted or rejected using the Metropolis criterion.\nIn addition to backrub moves, side chain conformations are sampled directly from the probability distributions described by the Dunbrack rotamer library, and not from a discrete set of chi angles, as is typically done by many side chain sampling algorithms. Side chain moves are also accepted or rejected using the Metropolis criterion.
LIMITATIONS==The backrub application does not sample either the backbone or side chain of proline residues. As long as a proline residue is specified as flexible, it can be part of backrub segments, but cannot be either the start or end pivot of a segment.\nOne of the primary differences between this implementation and the previous implementation is that backrub is now atom-centric rather than residue-centric. check_button_ck the references or RosettaCommons for more information on the change.
INPUTS==The starting structures must be in PDB format and can be specified using the -s or -l options. A custom fold tree can be specified on a single line of the PDB file using the silent file format. An overview of that format can be found in the fold tree documentation.\nSide chain sampling is controlled using the -resfile command line option. If no resfile is specified, then all side chains are made flexibile by default. Please see the resfile documentation for more information about how to create one. There are several things to note when using resfiles: First, because of current limitations with side chain sampling, proline resfiles are not sampled, even if specified in the resfile. Second, while it is possible to sample different amino acids using the backrub application, the fixed temperature Monte Carlo algorithm will bias the selected amino acids towards smaller residues such as alanine. Lastly, the residue numbering in resfiles is based on the residue number and chain letter from the PDB file, which is different from the -pivot_residues option.\nSimple phi/psi backbone moves can also be enabled by specifying a MoveMap file using the -movemap option and giving a greater than zero value to the -sm_prob option. See the MoveMap documentation for more information.
TIPS==To date, typical backrub ensemble generation has used 10,000 Monte Carlo steps at a temperature of 0.6. At this temperature, many structures will unfold if the number of Monte Carlo steps is increased significantly. Many structures remain stable in extended simulations at a temperature of 0.3-0.4.\nThe 10,000 step backrub simulations for a recent PDZ specificity prediction paper (Smith & Kortemme 2010) took an average of 110 seconds per simulation to generate a single structure. The simulations were each run on a single core of a heterogeneous cluster of 8 core Xeon workstations with E5345, E5430, and E5520 processors.
OUTPUTS==For each starting structure, an output tag will be generated from the input file name, suffix, prefix, and user tags, if applicable. The backrub application generates two files, output_tag_0001_low.pdb and output_tag_0001_last.pdb. The four digit index is incremented up to the number of structures specified by -nstruct. The "low" file contains the lowest energy structure found during the Monte Carlo simulation. The "last" file contains the last accepted structure during the Monte Carlo simulation. If a custom fold tree was given in the input file, it will be appended to each of the output files.
ANALYSIS==A useful form of post processing is to calculate the RMSD of the output structures to the input structure.
